# Databricks notebook source
# MAGIC %md #Preparation of feature store

# COMMAND ----------

# MAGIC %sql
# MAGIC CREATE DATABASE IF NOT EXISTS feature_store 

# COMMAND ----------

# MAGIC %sql
# MAGIC CREATE TABLE IF NOT EXISTS hive_metastore.feature_store.latest (
# MAGIC   user_id STRING,
# MAGIC   web_analytics_device_type_most_common_7d STRING,
# MAGIC   web_analytics_device_type_last_used_7d STRING,
# MAGIC   web_analytics_device_browser_most_common_7d STRING,
# MAGIC   web_analytics_device_browser_last_used_7d STRING,
# MAGIC   web_analytics_device_os_most_common_7d STRING,
# MAGIC   web_analytics_device_os_last_used_7d STRING,
# MAGIC   web_analytics_num_distinct_device_categories_7d BIGINT,
# MAGIC   web_analytics_channel_device_count_distinct_7d BIGINT,
# MAGIC   web_analytics_visit_time_most_common_7d STRING,
# MAGIC   web_analytics_mobile_user_7d DOUBLE,
# MAGIC   web_analytics_desktop_user_7d DOUBLE,
# MAGIC   web_analytics_smart_tv_user_7d DOUBLE,
# MAGIC   web_analytics_tablet_user_7d DOUBLE,
# MAGIC   web_analytics_time_on_site_avg_7d DOUBLE,
# MAGIC   web_analytics_web_active_7d INT,
# MAGIC   web_analytics_web_security_affinity_7d DOUBLE,
# MAGIC   web_analytics_page_search_engine_most_common_7d STRING,
# MAGIC   web_analytics_page_search_engine_last_used_7d STRING,
# MAGIC   web_analytics_pageviews_sum_7d BIGINT,
# MAGIC   owner_names_7d STRING,
# MAGIC   web_analytics_total_visits_7d BIGINT,
# MAGIC   web_analytics_blog_days_since_last_visit_7d INT,
# MAGIC   ad_interest_affinity_allergy DOUBLE,
# MAGIC   ad_interest_affinity_convertible DOUBLE,
# MAGIC   ad_interest_affinity_weight_loss DOUBLE,
# MAGIC   ad_interest_affinity_golf DOUBLE,
# MAGIC   ad_interest_affinity_clothing DOUBLE,
# MAGIC   ad_interest_affinity_remodeling_and_construction DOUBLE,
# MAGIC   ad_interest_affinity_photography DOUBLE,
# MAGIC   ad_interest_affinity_buying_or_selling_homes DOUBLE,
# MAGIC   ad_interest_affinity_asia DOUBLE,
# MAGIC   ad_interest_affinity_panic_or_anxiety_disorders DOUBLE,
# MAGIC   ad_interest_affinity_buying_or_selling_cars DOUBLE,
# MAGIC   ad_interest_affinity_motorcycles DOUBLE,
# MAGIC   ad_interest_affinity_elementary_school DOUBLE,
# MAGIC   ad_interest_affinity_pro_ice_hockey DOUBLE,
# MAGIC   ad_interest_affinity_australia_and_new_zealand DOUBLE,
# MAGIC   ad_interest_affinity_politics DOUBLE,
# MAGIC   ad_interest_affinity_video_and_computer_games DOUBLE,
# MAGIC   ad_interest_affinity_it_decision_makers DOUBLE,
# MAGIC   ad_interest_affinity_parenting DOUBLE,
# MAGIC   ad_interest_affinity_telecommuting DOUBLE,
# MAGIC   ad_interest_affinity_job_search DOUBLE,
# MAGIC   ad_interest_affinity_interior_decorating DOUBLE,
# MAGIC   ad_interest_affinity_high_school_students DOUBLE,
# MAGIC   ad_interest_affinity_pregnancy DOUBLE,
# MAGIC   ad_interest_affinity_animation DOUBLE,
# MAGIC   ad_interest_affinity_computer_reviews DOUBLE,
# MAGIC   ad_interest_affinity_traveling_with_kids DOUBLE,
# MAGIC   ad_interest_affinity_3_d_graphics DOUBLE,
# MAGIC   ad_interest_affinity_books_and_literature DOUBLE,
# MAGIC   ad_interest_affinity_board_games_or_puzzles DOUBLE,
# MAGIC   ad_interest_affinity_green_solutions DOUBLE,
# MAGIC   ad_interest_affinity_depression DOUBLE,
# MAGIC   ad_interest_affinity_gardening DOUBLE,
# MAGIC   ad_interest_affinity_cell_phones DOUBLE,
# MAGIC   ad_interest_affinity_college_life DOUBLE,
# MAGIC   ad_interest_affinity_local_news DOUBLE,
# MAGIC   ad_interest_affinity_financial_aid DOUBLE,
# MAGIC   ad_interest_affinity_guitar DOUBLE,
# MAGIC   ad_interest_affinity_canada DOUBLE,
# MAGIC   ad_interest_affinity_business_travel DOUBLE,
# MAGIC   ad_interest_affinity_insurance DOUBLE,
# MAGIC   ad_interest_affinity_south_america DOUBLE,
# MAGIC   ad_interest_affinity_performance_vehicles DOUBLE,
# MAGIC   ad_interest_affinity_agriculture DOUBLE,
# MAGIC   ad_interest_affinity_cigars DOUBLE,
# MAGIC   ad_interest_affinity_coffee_lovers DOUBLE,
# MAGIC   ad_interest_affinity_mens_health DOUBLE,
# MAGIC   ad_interest_affinity_dining_out DOUBLE,
# MAGIC   ad_interest_affinity_comic_books DOUBLE,
# MAGIC   ad_interest_affinity_mexico_and_central_america DOUBLE,
# MAGIC   ad_interest_affinity_hedge_fund DOUBLE,
# MAGIC   ad_interest_affinity_environmental_safety DOUBLE,
# MAGIC   ad_interest_affinity_humor DOUBLE,
# MAGIC   ad_interest_affinity_cold_and_flu DOUBLE,
# MAGIC   ad_interest_affinity_fashion DOUBLE,
# MAGIC   ad_interest_affinity_hr_software DOUBLE,
# MAGIC   ad_interest_affinity_financial_news DOUBLE,
# MAGIC   ad_interest_affinity_olympics DOUBLE,
# MAGIC   ad_interest_affinity_university_students DOUBLE,
# MAGIC   ad_interest_affinity_bodybuilding DOUBLE,
# MAGIC   ad_interest_affinity_generation_z DOUBLE,
# MAGIC   ad_interest_affinity_betting DOUBLE,
# MAGIC   ad_interest_affinity_astrology DOUBLE,
# MAGIC   ad_interest_affinity_teens DOUBLE,
# MAGIC   ad_interest_affinity_art_or_technology DOUBLE,
# MAGIC   ad_interest_affinity_fotovoltaics DOUBLE,
# MAGIC   ad_interest_affinity_dogs DOUBLE,
# MAGIC   ad_interest_affinity_fine_art DOUBLE,
# MAGIC   ad_interest_affinity_italy DOUBLE,
# MAGIC   ad_interest_affinity_cats DOUBLE,
# MAGIC   ad_interest_affinity_skateboarding DOUBLE,
# MAGIC   ad_interest_affinity_auto_parts DOUBLE,
# MAGIC   ad_interest_affinity_international_news DOUBLE,
# MAGIC   ad_interest_affinity_jewelry DOUBLE,
# MAGIC   ad_interest_affinity_advertising DOUBLE,
# MAGIC   ad_interest_affinity_diabetes DOUBLE,
# MAGIC   ad_interest_affinity_wine DOUBLE,
# MAGIC   ad_interest_affinity_b2b_small_and_midsize_business_osvc DOUBLE,
# MAGIC   ad_interest_affinity_weather DOUBLE,
# MAGIC   ad_interest_affinity_barbecues_and_grilling DOUBLE,
# MAGIC   ad_interest_affinity_vegan DOUBLE,
# MAGIC   ad_interest_affinity_energy_crisis DOUBLE,
# MAGIC   ad_interest_affinity_deal_hunters DOUBLE,
# MAGIC   ad_interest_affinity_christmas_shopping DOUBLE,
# MAGIC   ad_interest_affinity_trucks_and_accessories DOUBLE,
# MAGIC   ad_interest_affinity_movies DOUBLE,
# MAGIC   ad_interest_affinity_english_as_a_2nd_language DOUBLE,
# MAGIC   ad_interest_affinity_gay_life DOUBLE,
# MAGIC   ad_interest_affinity_cameras_and_camcorders DOUBLE,
# MAGIC   ad_interest_affinity_home_repair DOUBLE,
# MAGIC   ad_interest_affinity_radio DOUBLE,
# MAGIC   ad_interest_affinity_climbing DOUBLE,
# MAGIC   ad_interest_affinity_human_resources DOUBLE,
# MAGIC   ad_interest_affinity_music DOUBLE,
# MAGIC   ad_interest_affinity_celebrity_fan_or_gossip DOUBLE,
# MAGIC   ad_interest_affinity_football DOUBLE,
# MAGIC   ad_interest_affinity_exotic_pets DOUBLE,
# MAGIC   ad_interest_affinity_senior_living DOUBLE,
# MAGIC   ad_interest_affinity_data_centers DOUBLE,
# MAGIC   ad_interest_affinity_europe DOUBLE,
# MAGIC   ad_interest_affinity_usa DOUBLE,
# MAGIC   ad_interest_affinity_pro_basketball DOUBLE,
# MAGIC   ad_interest_affinity_mother_with_toddlers DOUBLE,
# MAGIC   ad_interest_affinity_credit_or_debt_and_loans DOUBLE,
# MAGIC   ad_interest_affinity_dating DOUBLE,
# MAGIC   ad_interest_affinity_electric_vehicle DOUBLE,
# MAGIC   ad_interest_affinity_internet_technology DOUBLE,
# MAGIC   ad_interest_affinity_b2b_big_corporations_managers_decision_makers DOUBLE,
# MAGIC   ad_interest_affinity_formule_1 DOUBLE,
# MAGIC   ad_interest_affinity_young_families_with_children DOUBLE,
# MAGIC   ad_interest_affinity_architects DOUBLE,
# MAGIC   ad_interest_affinity_boxing DOUBLE,
# MAGIC   ad_interest_affinity_womens_health DOUBLE,
# MAGIC   ad_interest_affinity_divorce_support DOUBLE,
# MAGIC   ad_interest_affinity_exotic_vacation DOUBLE,
# MAGIC   ad_interest_affinity_tattoos DOUBLE,
# MAGIC   ad_interest_affinity_luxury_vehicle DOUBLE,
# MAGIC   ad_interest_affinity_investments DOUBLE,
# MAGIC   ad_interest_affinity_middle_class_vehicle DOUBLE,
# MAGIC   ad_interest_affinity_suv_vehicle DOUBLE,
# MAGIC   ad_interest_affinity_eye_make_up DOUBLE,
# MAGIC   ad_interest_affinity_make_up DOUBLE,
# MAGIC   ad_interest_affinity_beauty DOUBLE,
# MAGIC   ad_interest_affinity_education DOUBLE,
# MAGIC   ad_interest_affinity_science DOUBLE,
# MAGIC   ad_interest_affinity_family_and_parenting DOUBLE,
# MAGIC   ad_interest_affinity_sports DOUBLE,
# MAGIC   ad_interest_affinity_careers DOUBLE,
# MAGIC   ad_interest_affinity_travel DOUBLE,
# MAGIC   ad_interest_affinity_real_estate DOUBLE,
# MAGIC   ad_interest_affinity_pets DOUBLE,
# MAGIC   ad_interest_affinity_society DOUBLE,
# MAGIC   ad_interest_affinity_shopping DOUBLE,
# MAGIC   ad_interest_affinity_home_and_garden DOUBLE,
# MAGIC   ad_interest_affinity_automotive DOUBLE,
# MAGIC   ad_interest_affinity_personal_finance DOUBLE,
# MAGIC   ad_interest_affinity_business DOUBLE,
# MAGIC   ad_interest_affinity_law_govt_and_politics DOUBLE,
# MAGIC   ad_interest_affinity_b2b DOUBLE,
# MAGIC   ad_interest_affinity_food_and_drink DOUBLE,
# MAGIC   ad_interest_affinity_health_and_fitness DOUBLE,
# MAGIC   ad_interest_affinity_arts_and_entertainment DOUBLE,
# MAGIC   ad_interest_affinity_hobbies_and_interests DOUBLE,
# MAGIC   ad_interest_affinity_style_and_fashion DOUBLE,
# MAGIC   ad_interest_affinity_technology_and_computing DOUBLE,
# MAGIC   ad_interest_affinity_news DOUBLE,
# MAGIC   ad_interest_affinity_home_tech_equipment DOUBLE,
# MAGIC   ad_interest_affinity_bathrooms DOUBLE,
# MAGIC   ad_interest_affinity_distillates DOUBLE,
# MAGIC   income_model_score_low DOUBLE,
# MAGIC   income_model_score_mid DOUBLE,
# MAGIC   income_model_score_high DOUBLE,
# MAGIC   income_model_perc_low DOUBLE,
# MAGIC   income_model_perc_mid DOUBLE,
# MAGIC   income_model_perc_high DOUBLE,
# MAGIC   edu_model_score_zs DOUBLE,
# MAGIC   edu_model_score_ss_no DOUBLE,
# MAGIC   edu_model_score_ss_yes DOUBLE,
# MAGIC   edu_model_score_vs DOUBLE,
# MAGIC   edu_model_perc_zs DOUBLE,
# MAGIC   edu_model_perc_ss_no DOUBLE,
# MAGIC   edu_model_perc_ss_yes DOUBLE,
# MAGIC   edu_model_perc_vs DOUBLE,
# MAGIC   sociodemo_prob_agegroup_0_17 DOUBLE,
# MAGIC   sociodemo_perc_agegroup_0_17 DOUBLE,
# MAGIC   sociodemo_prob_agegroup_18_24 DOUBLE,
# MAGIC   sociodemo_perc_agegroup_18_24 DOUBLE,
# MAGIC   sociodemo_prob_agegroup_25_34 DOUBLE,
# MAGIC   sociodemo_perc_agegroup_25_34 DOUBLE,
# MAGIC   sociodemo_prob_agegroup_35_44 DOUBLE,
# MAGIC   sociodemo_perc_agegroup_35_44 DOUBLE,
# MAGIC   sociodemo_prob_agegroup_45_54 DOUBLE,
# MAGIC   sociodemo_perc_agegroup_45_54 DOUBLE,
# MAGIC   sociodemo_prob_agegroup_55_64 DOUBLE,
# MAGIC   sociodemo_perc_agegroup_55_64 DOUBLE,
# MAGIC   sociodemo_prob_agegroup_65_100 DOUBLE,
# MAGIC   sociodemo_perc_agegroup_65_100 DOUBLE,
# MAGIC   sociodemo_prob_gender_male DOUBLE,
# MAGIC   sociodemo_perc_gender_male DOUBLE,
# MAGIC   sociodemo_perc_gender_female DOUBLE,
# MAGIC   sociodemo_prob_gender_female DOUBLE,
# MAGIC   sociodemo_targets_age STRING,
# MAGIC   sociodemo_targets_gender STRING,
# MAGIC   lookalike_targets STRING,
# MAGIC   lookalike_prob_dmp_aa9bqvteomrl_cpex DOUBLE,
# MAGIC   lookalike_perc_dmp_aa9bqvteomrl_cpex DOUBLE,
# MAGIC   lookalike_prob_dmp_aa9bom9sdj6m_cpex DOUBLE,
# MAGIC   lookalike_perc_dmp_aa9bom9sdj6m_cpex DOUBLE,
# MAGIC   lookalike_target_dmp_aa9bqvteomrl_cpex INT,
# MAGIC   lookalike_target_dmp_aa9bom9sdj6m_cpex INT,
# MAGIC   a_score DOUBLE,
# MAGIC   b_score DOUBLE,
# MAGIC   c_score DOUBLE,
# MAGIC   d_score DOUBLE,
# MAGIC   e_score DOUBLE,
# MAGIC   a_perc DOUBLE,
# MAGIC   b_perc DOUBLE,
# MAGIC   c_perc DOUBLE,
# MAGIC   d_perc DOUBLE,
# MAGIC   e_perc DOUBLE,
# MAGIC   ad_interest_affinity_truck_drivers DOUBLE,
# MAGIC   ad_interest_affinity_womens_fashion DOUBLE,
# MAGIC   ad_interest_affinity_cosmetics DOUBLE,
# MAGIC   ad_interest_affinity_beer DOUBLE,
# MAGIC   ad_interest_affinity_black_friday DOUBLE,
# MAGIC   ad_interest_affinity_martial_arts DOUBLE,
# MAGIC   ad_interest_affinity_mortgage DOUBLE,
# MAGIC   ad_interest_affinity_skiing DOUBLE,
# MAGIC   ad_interest_affinity_mma DOUBLE)
# MAGIC USING delta
# MAGIC LOCATION 'dbfs:/mnt/aam-cpex-dev/solutions/mt-test/fs.delta'  --TODO
